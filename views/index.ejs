
<!-- include header -->
    <%- include('include/_header') %>
<!-- /include header -->


<script>
    function createNewCategory() {
        var newCategoryInputValue = document.getElementById("newCategoryInput").value;
        var selectedCategory = document.getElementById("categoryDropdown").value;
        // Prepare the data to be sent in the request body
        var data = {
            selectedCategory: selectedCategory,
            newCategory: newCategoryInputValue
        };

        fetch('/createCategory', {
                method: 'POST',
                body: JSON.stringify(data),
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => {
                if (!response.ok) {
                    alert("Error!!! Something wasn't okay");
                    location.reload();
                }
                return response.json();
            })
            .then(result => {
                // Handle the result if needed
                console.log(result);
            })
            .catch(error => {
                // Handle errors
                console.error('Error:', error);
            });






    }

    function createNewSubcategory() {
        // Add logic for creating a new subcategory
        alert("Creating a new subcategory!");
    }


    document.addEventListener('DOMContentLoaded', function () {
      fetch('/accountTypes')
        .then(response => response.json())
        .then(data => {
        console.log(data);
          const { accountTypes } = data;
          const accountTypeSelect = document.querySelector('[id="categoryDropdown"]');
          // Check if the element exists before appending options
          if (accountTypeSelect) {
            accountTypes.forEach(accountType => {
              const option = document.createElement('option');
              option.value = accountType;
              option.text = accountType;
              accountTypeSelect.appendChild(option);
            });
          } else {
            console.error('Element with name "accountType" not found');
          }
        })
        .catch(error => console.error('Error fetching Account Types:', error));
    });





</script>


<div class="category">
    <div class="label-container">
        <label class="btn text-dark">New Category</label>
    </div>
    <div id="newCategoryInputContainer">
        <label for="newCategoryInput">Select Account Type</label>
        <select id="categoryDropdown">
        </select>
        <input type="text" id="newCategoryInput" placeholder="Enter new category">
        <button onclick="createNewCategory()" class="btn text-dark">Create</button>
    </div>
</div>


<div class="category">
    <div class="label-container">
        <label  class="btn text-dark">New Subcategory</label>
    </div>
    <div id="newCategoryInputContainer">
        <label for="newSubcategoryInput">Select Category:</label>
        <select id="subcategoryDropdown">
            <option value="subcategory1">Category 1</option>
            <option value="subcategory2">Category 2</option>
        </select>
        <input type="text" id="newSubcategoryInput" placeholder="Enter new subcategory">
        <button onclick="createNewSubcategory()" class="btn text-dark">Create</button>
    </div>
</div>

    <!-- Main Site -->
    <main id="site-main">
        <div class="container">
            <div class="form-title text-center">
                <h2 class="text-dark">Welcome to ShikkhaDekkha Accounts</h2>
                <span class="text-light">Complete the form below to record a transaction.</span>
            </div>

            <!-- add user form -->
            <%- include('include/_form') %>
           
        </div>
    </main>
<!-- /Main Site -->


<!-- include footer -->
<%- include('include/_footer') %>
<!-- /include footer -->